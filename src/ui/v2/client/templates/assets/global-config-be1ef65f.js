import{f as r,g as E,h as S,o as v,i as $,w as n,d as e,c as C,a as b,u as N,k as B,b as F,j as G}from"./_plugin-vue_export-helper-8cf34f94.js";import{u as V,_ as O,f as u,c as T}from"./api-c8d35a00.js";import{_ as I}from"./State-12c471ac.js";import{_ as J}from"./Base-dee1bee9.js";import{c as M,_ as d,b as f,a as z}from"./Base-7e2e8ada.js";import{u as A,g as j,_ as D,a as L,b as R}from"./Structure-0cfe2d7a.js";import{_ as h}from"./Select-ab98952b.js";import{g as U,s as q,a as H}from"./plugins-9c6b5ad6.js";const K={key:0,class:"col-span-12 content-wrap"},Q={class:"col-span-12 flex"},W={class:"col-span-12 flex w-full justify-center mt-8 mb-2"},X={__name:"GlobalConfig",setup(Z){const g=A(),o=V(),i=r({keyword:"",method:""}),a=r({isPend:!1,isErr:!1,data:[],activePlugin:"",activePlugins:[],setup:E(()=>{if(a.isErr||a.isPend||!a.data||a.data.length===0||t.isErr||t.isPend||!t.data||t.data.length===0)return a.active="",[];const m=U(JSON.parse(JSON.stringify(a.data)),"global"),s=JSON.parse(JSON.stringify(t.data.global)),l=q(m),x=H(l,s),_=j(x,i),P=[];return _.forEach(c=>{c.isMatchFilter&&P.push(c.name)}),a.activePlugins=P,a.activePlugin||(a.activePlugin=a.activePlugins.length>0?a.activePlugins[0]:""),a.activePlugin&&(a.activePlugins.indexOf(a.activePlugin)!==-1||(a.activePlugin=a.activePlugins.length>0?a.activePlugins[0]:"")),_})}),t=r({isPend:!1,isErr:!1,data:[]});async function p(){t.isPend=!0,a.isPend=!0,await u("/api/config?methods=1&new_format=1","GET",null,t,o.addFeedback),await u("/api/plugins","GET",null,a,o.addFeedback)}S(async()=>{await p()});function w(){i.label="",g.$reset()}function k(){p(),w()}async function y(){await u("/api/config/global?method=ui","PUT",g.data.global,null,o.addFeedback)}return(m,s)=>(v(),$(O,null,{default:n(()=>[e(I,{class:"col-span-4 col-start-5",isErr:a.isErr,isPend:a.isPend,isData:!0},null,8,["isErr","isPend"]),!a.isErr&&!a.isPend?(v(),C("div",K,[e(f,{class:"z-100 h-fit col-span-12 md:col-span-5 lg:col-span-4 3xl:col-span-3 grid grid-cols-12 relative"},{default:n(()=>[b("div",Q,[e(M,{label:"global config"}),e(D,{onRefresh:s[0]||(s[0]=l=>k())})]),e(d,{class:"flex w-full col-span-12",label:"Select plugin",name:"plugins"},{default:n(()=>[e(h,{onInp:s[1]||(s[1]=l=>a.activePlugin=l),settings:{id:"plugins",value:a.activePlugin,values:a.activePlugins,placeholder:"Search"}},null,8,["settings"])]),_:1})]),_:1}),e(f,{label:"filter",class:"z-10 h-fit col-span-12 md:col-span-7 lg:col-span-5 3xl:col-span-3 grid grid-cols-12 relative"},{default:n(()=>[e(d,{class:"flex w-full col-span-12 md:col-span-6",label:"Search",name:"keyword"},{default:n(()=>[e(z,{onInp:s[2]||(s[2]=l=>i.keyword=l),settings:{id:"keyword",type:"text",value:"",placeholder:"label"}})]),_:1}),e(d,{class:"flex w-full col-span-12 md:col-span-6",label:"Method",name:"keyword"},{default:n(()=>[e(h,{onInp:s[3]||(s[3]=l=>i.method=l),settings:{id:"keyword",value:"all",values:N(R)(),placeholder:"Search"}},null,8,["settings"])]),_:1})]),_:1}),e(f,{class:"col-span-12 grid grid-cols-12 relative"},{default:n(()=>[e(L,{plugins:a.setup,active:a.activePlugin},null,8,["plugins","active"]),b("div",W,[e(J,{onClick:s[4]||(s[4]=l=>y()),color:"valid",size:"lg"},{default:n(()=>[B(" SAVE ")]),_:1})])]),_:1})])):F("",!0)]),_:1}))}},Y=T();G(X).use(Y).mount("#app");
